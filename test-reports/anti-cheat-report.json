{
  "summary": {
    "total_violations": 67,
    "high_violations": 60,
    "medium_violations": 7,
    "low_violations": 0,
    "should_fail": true,
    "failure_reasons": [
      "60 个高严重程度违规",
      "违规总数 67 超过允许的 20"
    ],
    "ci_system": "unknown",
    "is_ci": false
  },
  "violations": [
    {
      "type": "api_boundary_violation",
      "file": "v2\\tests\\unit\\test_streamlit_app.py",
      "line": 25,
      "column": 0,
      "severity": "HIGH",
      "description": "UI测试违规导入core模块: v2.core.state",
      "code": "from v2.core.state import GameState"
    },
    {
      "type": "api_boundary_violation",
      "file": "v2\\tests\\unit\\test_streamlit_app.py",
      "line": 26,
      "column": 0,
      "severity": "HIGH",
      "description": "UI测试违规导入core模块: v2.core.enums",
      "code": "from v2.core.enums import Phase, ActionType, SeatStatus"
    },
    {
      "type": "api_boundary_violation",
      "file": "v2\\tests\\unit\\test_streamlit_app.py",
      "line": 27,
      "column": 0,
      "severity": "HIGH",
      "description": "UI测试违规导入core模块: v2.core.cards",
      "code": "from v2.core.cards import Card, Suit, Rank"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_controller_atomic.py",
      "line": 143,
      "column": 16,
      "severity": "HIGH",
      "description": "直接修改私有属性: _game_state",
      "code": "self._game_state = \"not a GameState\""
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_health_checker.py",
      "line": 52,
      "column": 12,
      "severity": "HIGH",
      "description": "使用危险操作: setattr",
      "code": "setattr(snapshot, key, value)"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 21,
      "column": 8,
      "severity": "HIGH",
      "description": "直接修改私有属性: _big_blind",
      "code": "self._big_blind = big_blind"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 23,
      "column": 8,
      "severity": "HIGH",
      "description": "直接修改私有属性: _current_player_seat",
      "code": "self._current_player_seat = current_player_seat"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 220,
      "column": 8,
      "severity": "HIGH",
      "description": "直接修改私有属性: _current_player_seat",
      "code": "self.game_state._current_player_seat = 2  # Different player's turn"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 236,
      "column": 8,
      "severity": "HIGH",
      "description": "直接修改私有属性: _current_player_seat",
      "code": "self.game_state._current_player_seat = None"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 49,
      "column": 0,
      "severity": "HIGH",
      "description": "间接篡改私有状态（字典访问）: __dict__\\[.*_.*\\]",
      "code": "game.__dict__['_game_state'] = \"hacked\""
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 50,
      "column": 0,
      "severity": "HIGH",
      "description": "间接篡改私有状态（字典访问）: vars\\(.*\\)\\[.*_.*\\]",
      "code": "vars(game)['_players'] = []"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 51,
      "column": 0,
      "severity": "HIGH",
      "description": "间接篡改私有状态（字典访问）: __dict__\\[.*_.*\\]",
      "code": "obj.__dict__['_private_attr'] = \"value\""
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 72,
      "column": 0,
      "severity": "MEDIUM",
      "description": "循环遍历篡改私有状态: for.*in.*__dict__",
      "code": "for attr in game.__dict__:"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 77,
      "column": 0,
      "severity": "MEDIUM",
      "description": "循环遍历篡改私有状态: for.*in.*vars\\(",
      "code": "for key in vars(game):"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 132,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, attr_name, \"hacked\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 135,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_\" + \"dynamic\", \"value\")"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 136,
      "column": 0,
      "severity": "HIGH",
      "description": "间接篡改私有状态（字典访问）: getattr\\(.*,.*_.*\\)",
      "code": "getattr(game, \"_\" + \"attr\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 156,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_game_state\", \"hacked\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 157,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_players\", [])"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 160,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: delattr\\(.*,.*_.*\\)",
      "code": "delattr(game, \"_deck\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 163,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "if hasattr(game, \"_private_data\"):"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 189,
      "column": 0,
      "severity": "HIGH",
      "description": "间接篡改私有状态（字典访问）: __dict__\\[.*_.*\\]",
      "code": "game.__dict__['_players'] = []"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 192,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_deck\", [])"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 233,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_data\", \"value\")  # 危险操作"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 259,
      "column": 0,
      "severity": "MEDIUM",
      "description": "循环遍历篡改私有状态: for.*in.*__dict__",
      "code": "for attr in game.__dict__:"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 265,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, attr_name, \"value\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 319,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_data\", \"value\")"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 43,
      "column": 0,
      "severity": "MEDIUM",
      "description": "测试帮凶：提供私有状态访问的辅助方法",
      "code": "def test_dict_access_tampering_detection(self):"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 110,
      "column": 0,
      "severity": "MEDIUM",
      "description": "测试帮凶：提供私有状态访问的辅助方法",
      "code": "def get_private_state(obj):"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 135,
      "column": 0,
      "severity": "MEDIUM",
      "description": "动态篡改：字符串构造属性名",
      "code": "setattr(game, \"_\" + \"dynamic\", \"value\")"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\meta\\test_enhanced_detector.py",
      "line": 136,
      "column": 0,
      "severity": "MEDIUM",
      "description": "动态篡改：字符串构造属性名",
      "code": "getattr(game, \"_\" + \"attr\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_integrity_guard.py",
      "line": 72,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_private_attr\", \"hacked\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\meta\\test_integrity_guard.py",
      "line": 179,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: setattr\\(.*,.*_.*,.*\\)",
      "code": "setattr(game, \"_another_private\", \"value\")"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_streamlit_app.py",
      "line": 46,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(mock_session_state, 'game_started')"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_streamlit_app.py",
      "line": 48,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(mock_session_state, 'debug_mode')"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_pot.py",
      "line": 337,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "assert self.pot_manager._total_collected == 0"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_streamlit_debug_features.py",
      "line": 32,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "mock_controller._logger = Mock()"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_streamlit_debug_features.py",
      "line": 57,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "mock_controller._logger = Mock()"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_streamlit_debug_features.py",
      "line": 102,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "mock_controller._logger = Mock()"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_streamlit_debug_features.py",
      "line": 165,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "mock_controller._logger = Mock()"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_streamlit_log_visualization.py",
      "line": 41,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(mock_st.session_state, 'log_file_path')"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_streamlit_session_state.py",
      "line": 123,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(controller, 'start_new_hand')"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_streamlit_session_state.py",
      "line": 124,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(controller, 'execute_action')"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_streamlit_session_state.py",
      "line": 125,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(controller, 'get_snapshot')"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_streamlit_session_state.py",
      "line": 126,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(controller, 'is_hand_over')"
    },
    {
      "type": "dangerous_operation",
      "file": "v2\\tests\\unit\\test_v2_streamlit_session_state.py",
      "line": 127,
      "column": 0,
      "severity": "HIGH",
      "description": "函数调用篡改私有状态: hasattr\\(.*,.*_.*\\)",
      "code": "assert hasattr(controller, 'get_current_player_id')"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 77,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 95,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 105,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 1500  # More than player's chips"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 126,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 152,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 153,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._last_raise_amount = 10"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 170,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 171,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._last_raise_amount = 20"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 179,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 180,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._last_raise_amount = 20"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 181,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._player_bets = {1: 0}  # Player hasn't bet yet"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 193,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 100"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 194,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._player_bets = {1: 0}"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 220,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_player_seat = 2  # Different player's turn"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 236,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_player_seat = None"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 249,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 100"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 250,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._player_bets = {1: 30}  # Player has already bet 30"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 267,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 279,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._current_bet = 50"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 280,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._last_raise_amount = 10"
    },
    {
      "type": "private_state_tampering",
      "file": "v2\\tests\\unit\\test_v2_validator.py",
      "line": 281,
      "column": 0,
      "severity": "HIGH",
      "description": "测试帮凶：恶意工厂方法包含私有状态篡改",
      "code": "self.game_state._player_bets = {1: 0}"
    }
  ]
}